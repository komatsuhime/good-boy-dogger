<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Good Boy Dogger</title>
    <!-- by Carla Faroldi -->
    <script src="js/ga.js"></script>
    <script src="js/plugins.js"></script>
  </head>

  <body>
<script>
var dogger = ga(512, 512, setup);

dogger.start();

var dog, food, garbage, barks, gameScene, GameOverScene;

function setup() {
	dogger.canvas.style.border = "1px black dashed";
	dogger.backgroundColor = "white";

	gameScene = dogger.group();
	dog = dogger.rectangle(24, 24, "pink");
	dog.x = 68;
	dog.y = dogger.canvas.height / 2 - dog.halfHeight;
	gameScene.addChild(dog);

	food = dogger.rectangle(24, 24, "orange");
	food.x = 30;
	food.y = 30;
	food.eaten = false;
	gameScene.addChild(food);

	var garbageTotal = dogger.randomInt(1, 6);

	garbages = [];

	for (var i = 0; i < garbageTotal; i++)
	{
		garbage = dogger.rectangle(24, 24, "grey");
		garbage.x = dogger.randomInt(0, 513);
		garbage.y = dogger.randomInt(0, 513);
		garbages.push(garbage);
		gameScene.addChild(garbage);
	}



	dogger.fourKeyController(dog, 5, 38, 39, 40, 37);
	dogger.state = play;
}

function play() {
	dogger.move(dog);
	dogger.contain(dog, dogger.stage.localBounds);

	if (dogger.move(dog)) {
	var test = dogger.rectangle(10, 10, "blue", 10, 20);
	gameScene.addChild(test);
	}
	garbages.forEach(function(garbage) {
						 dogger.contain(garbage, dogger.stage.localBounds);
						 garbage.x += 5;
						 garbage.y += 5;
					 });

	var garbageEaten = false;
	garbages.forEach(function(garbage) {
						 if (dogger.hitTestRectangle(dog, garbage))
						 {
							 garbageEaten = true;
						 }
					 });

	if (garbageEaten)
	{
		dog.alpha = 0.5;
	}
	else
	{
		dog.alpha = 1;
	}

	if (dogger.hitTestRectangle(dog, food))
	{
		food.x = dog.x + 12;
		food.y = dog.y + 12;
		food.eaten = true;
		console.log(food.eaten);
	}
}
</script>
  </body>

</html>
